ylab("Whatever there") +
ggtitle(" Serine ") +
theme(plot.title = element_text(vjust = -3, face = "bold", size = 20))
ggplot(serine_subset, aes(x = Condition.3, y = relative_resp, shape = Condition.1, col = Condition.1)) +
geom_point(size = 10, position = position_dodge(width = 0.8)) +
scale_color_brewer(type = "qual") +
theme(panel.background = element_rect(color = "red", size = 5, linetype = "dashed")) +
theme(axis.ticks.x = element_line(color = "darkblue", size = 2))+
theme(aspect.ratio = 1) +
# xlab("Whatever") +
# ylab("Whatever there") +
# ggtitle(" Serine ") +
theme(plot.title = element_text(vjust = -3, face = "bold", size = 20)) +
labs(x = "somtehing", y = "respo", title = "Serine", caption = "Fig. 1 Serine data")
ggplot(serine_subset, aes(x = Condition.3, y = relative_resp, shape = Condition.1, col = Condition.1)) +
geom_point(size = 10, position = position_dodge(width = 0.8)) +
scale_color_brewer(type = "qual") +
theme(panel.background = element_rect(color = "red", size = 5, linetype = "dashed")) +
theme(axis.ticks.x = element_line(color = "darkblue", size = 2))+
theme(aspect.ratio = 1) +
# xlab("Whatever") +
# ylab("Whatever there") +
# ggtitle(" Serine ") +
theme(plot.title = element_text(vjust = 3, face = "bold", size = 20)) +
labs(x = "somtehing", y = "respo", title = "Serine", caption = "Fig. 1 Serine data")
ggplot(serine_subset, aes(x = Condition.3, y = relative_resp, shape = Condition.1, col = Condition.1)) +
geom_point(size = 10, position = position_dodge(width = 0.8)) +
scale_color_brewer(type = "qual") +
theme(panel.background = element_rect(color = "red", size = 5, linetype = "dashed")) +
theme(axis.ticks.x = element_line(color = "darkblue", size = 2))+
theme(aspect.ratio = 1) +
# xlab("Whatever") +
# ylab("Whatever there") +
# ggtitle(" Serine ") +
theme(plot.title = element_text(vjust = 3, face = "bold", size = 20)) +
labs(x = "somtehing", y = "respo", title = "Serine", caption = "Fig. 1 Serine data") +
theme(legend.position = "bottom")
ggplot(serine_subset, aes(x = Condition.3, y = relative_resp, shape = Condition.1, col = Condition.1)) +
geom_point(size = 10, position = position_dodge(width = 0.8)) +
scale_color_brewer(type = "qual") +
theme(panel.background = element_rect(color = "red", size = 5, linetype = "dashed")) +
theme(axis.ticks.x = element_line(color = "darkblue", size = 2))+
theme(aspect.ratio = 1) +
# xlab("Whatever") +
# ylab("Whatever there") +
# ggtitle(" Serine ") +
theme(plot.title = element_text(vjust = 3, face = "bold", size = 20)) +
labs(x = "somtehing", y = "respo", title = "Serine", caption = "Fig. 1 Serine data") +
theme(legend.position = "bottom", legend.direction = "vertical")
ggplot(serine_subset, aes(x = Condition.3, y = relative_resp, shape = Condition.1, col = Condition.3)) +
geom_point(size = 10, position = position_dodge(width = 0.8)) +
scale_color_brewer(type = "qual") +
theme(panel.background = element_rect(color = "red", size = 5, linetype = "dashed")) +
theme(axis.ticks.x = element_line(color = "darkblue", size = 2))+
theme(aspect.ratio = 1) +
# xlab("Whatever") +
# ylab("Whatever there") +
# ggtitle(" Serine ") +
theme(plot.title = element_text(vjust = 3, face = "bold", size = 20)) +
labs(x = "somtehing", y = "respo", title = "Serine", caption = "Fig. 1 Serine data") +
theme(legend.position = "bottom", legend.direction = "vertical")
ggplot(serine_subset, aes(x = Condition.3, y = relative_resp, shape = Condition.1, col = Condition.3)) +
geom_point(size = 10, position = position_dodge(width = 0.8)) +
scale_color_brewer(type = "qual") +
theme(panel.background = element_rect(color = "red", size = 5, linetype = "dashed")) +
theme(axis.ticks.x = element_line(color = "darkblue", size = 2))+
theme(aspect.ratio = 1) +
# xlab("Whatever") +
# ylab("Whatever there") +
# ggtitle(" Serine ") +
theme(plot.title = element_text(vjust = 3, face = "bold", size = 20)) +
labs(x = "somtehing", y = "respo", title = "Serine", caption = "Fig. 1 Serine data") +
theme(legend.position = "bottom", legend.direction = "vertical", legend.box.just = "bottom")
ggplot(serine_subset, aes(x = Condition.3, y = relative_resp, shape = Condition.1, col = Condition.3)) +
geom_point(size = 10, position = position_dodge(width = 0.8)) +
scale_color_brewer(type = "qual") +
theme(panel.background = element_rect(color = "red", size = 5, linetype = "dashed")) +
theme(axis.ticks.x = element_line(color = "darkblue", size = 2))+
theme(aspect.ratio = 1) +
# xlab("Whatever") +
# ylab("Whatever there") +
# ggtitle(" Serine ") +
theme(plot.title = element_text(vjust = 3, face = "bold", size = 20)) +
labs(x = "somtehing", y = "respo", title = "Serine", caption = "Fig. 1 Serine data") +
theme(legend.position = "bottom", legend.direction = "vertical", legend.box.just = "top")
ggplot(serine_subset, aes(x = Condition.3, y = relative_resp, shape = Condition.1, col = Condition.3)) +
geom_point(size = 10, position = position_dodge(width = 0.8)) +
scale_color_brewer(type = "qual") +
theme(panel.background = element_rect(color = "red", size = 5, linetype = "dashed")) +
theme(axis.ticks.x = element_line(color = "darkblue", size = 2))+
theme(aspect.ratio = 1) +
# xlab("Whatever") +
# ylab("Whatever there") +
# ggtitle(" Serine ") +
theme(plot.title = element_text(vjust = 3, face = "bold", size = 20)) +
labs(x = "somtehing", y = "respo", title = "Serine", caption = "Fig. 1 Serine data") +
theme(legend.position = "bottom", legend.direction = "vertical")
ggplot(serine_subset, aes(x = Condition.3, y = relative_resp, shape = Condition.1, col = Condition.3)) +
geom_point(size = 10, position = position_dodge(width = 0.8)) +
scale_color_brewer(type = "qual") +
theme(panel.background = element_rect(color = "red", size = 5, linetype = "dashed")) +
theme(axis.ticks.x = element_line(color = "darkblue", size = 2))+
theme(aspect.ratio = 1) +
# xlab("Whatever") +
# ylab("Whatever there") +
# ggtitle(" Serine ") +
theme(plot.title = element_text(vjust = 3, face = "bold", size = 20)) +
labs(x = "somtehing", y = "respo", title = "Serine", caption = "Fig. 1 Serine data") +
# theme(legend.position = "bottom", legend.direction = "vertical")
theme(legend.position = c(0.5, 0.5), legend.direction = "vertical")
ggplot(serine_subset, aes(x = Condition.3, y = relative_resp, shape = Condition.1, col = Condition.3)) +
geom_point(size = 10, position = position_dodge(width = 0.8)) +
scale_color_brewer(type = "qual") +
theme(panel.background = element_rect(color = "red", size = 5, linetype = "dashed")) +
theme(axis.ticks.x = element_line(color = "darkblue", size = 2))+
theme(aspect.ratio = 1) +
# xlab("Whatever") +
# ylab("Whatever there") +
# ggtitle(" Serine ") +
theme(plot.title = element_text(vjust = 3, face = "bold", size = 20)) +
labs(x = "somtehing", y = "respo", title = "Serine", caption = "Fig. 1 Serine data") +
# theme(legend.position = "bottom", legend.direction = "vertical")
theme(legend.position = c(0.9, 0.9), legend.direction = "vertical")
ggplot(serine_subset, aes(x = Condition.3, y = relative_resp, shape = Condition.1, col = Condition.3)) +
geom_point(size = 10, position = position_dodge(width = 0.8)) +
scale_color_brewer(type = "qual") +
theme(panel.background = element_rect(color = "red", size = 5, linetype = "dashed")) +
theme(axis.ticks.x = element_line(color = "darkblue", size = 2))+
theme(aspect.ratio = 1) +
# xlab("Whatever") +
# ylab("Whatever there") +
# ggtitle(" Serine ") +
theme(plot.title = element_text(vjust = 3, face = "bold", size = 20)) +
labs(x = "somtehing", y = "respo", title = "Serine", caption = "Fig. 1 Serine data") +
# theme(legend.position = "bottom", legend.direction = "vertical")
theme(legend.position = c(0.9, 0.9), legend.direction = "vertical", legend.box = element_rect(fill = "black"))
ggplot(serine_subset, aes(x = Condition.3, y = relative_resp, shape = Condition.1, col = Condition.3)) +
geom_point(size = 10, position = position_dodge(width = 0.8)) +
scale_color_brewer(type = "qual") +
theme(panel.background = element_rect(color = "red", size = 5, linetype = "dashed")) +
theme(axis.ticks.x = element_line(color = "darkblue", size = 2))+
theme(aspect.ratio = 1) +
# xlab("Whatever") +
# ylab("Whatever there") +
# ggtitle(" Serine ") +
theme(plot.title = element_text(vjust = 3, face = "bold", size = 20)) +
labs(x = "somtehing", y = "respo", title = "Serine", caption = "Fig. 1 Serine data") +
# theme(legend.position = "bottom", legend.direction = "vertical")
theme(legend.position = c(0.9, 0.9), legend.direction = "vertical", legend.background = element_rect(fill = "black"))
ggplot(serine_subset, aes(x = Condition.3, y = relative_resp, shape = Condition.1, col = Condition.3)) +
geom_point(size = 10, position = position_dodge(width = 0.8)) +
scale_color_brewer(type = "qual") +
theme(panel.background = element_rect(color = "red", size = 5, linetype = "dashed")) +
theme(axis.ticks.x = element_line(color = "darkblue", size = 2))+
theme(aspect.ratio = 1) +
# xlab("Whatever") +
# ylab("Whatever there") +
# ggtitle(" Serine ") +
theme(plot.title = element_text(vjust = 3, face = "bold", size = 20)) +
labs(x = "somtehing", y = "respo", title = "Serine", caption = "Fig. 1 Serine data") +
# theme(legend.position = "bottom", legend.direction = "vertical")
theme(legend.position = c(0.9, 0.9), legend.direction = "vertical", legend.background = element_rect(fill = "green"))
ggplot(serine_subset, aes(x = Condition.3, y = relative_resp, shape = Condition.1, col = Condition.3)) +
geom_point(size = 10, position = position_dodge(width = 0.8)) +
scale_color_brewer(type = "qual") +
theme(panel.background = element_rect(color = "red", size = 5, linetype = "dashed")) +
theme(axis.ticks.x = element_line(color = "darkblue", size = 2))+
theme(aspect.ratio = 1) +
# xlab("Whatever") +
# ylab("Whatever there") +
# ggtitle(" Serine ") +
theme(plot.title = element_text(vjust = 3, face = "bold", size = 20)) +
labs(x = "somtehing", y = "respo", title = "Serine", caption = "Fig. 1 Serine data") +
# theme(legend.position = "bottom", legend.direction = "vertical")
theme(legend.position = c(0.9, 0.9), legend.direction = "vertical", legend.background = element_rect(fill = "green")) +
theme(axis.title.x = element_text(size = 20), axis.title.y = element_text(size = 10, face = "italic"))
ggplot(serine_subset, aes(x = Condition.3, y = relative_resp, shape = Condition.1, col = Condition.3)) +
geom_point(size = 10, position = position_dodge(width = 0.8)) +
scale_color_brewer(type = "qual") +
theme(panel.background = element_rect(color = "red", size = 5, linetype = "dashed")) +
theme(axis.ticks.x = element_line(color = "darkblue", size = 2))+
theme(aspect.ratio = 1) +
# xlab("Whatever") +
# ylab("Whatever there") +
# ggtitle(" Serine ") +
theme(plot.title = element_text(vjust = 3, face = "bold", size = 20)) +
labs(x = "somtehing", y = "respo", title = "Serine", caption = "Fig. 1 Serine data") +
# theme(legend.position = "bottom", legend.direction = "vertical")
theme(legend.position = c(0.9, 0.9), legend.direction = "vertical", legend.background = element_rect(fill = "green")) +
theme(axis.title.x = element_text(size = 20), axis.title.y = element_text(size = 30, face = "italic"))
ggplot(serine_subset, aes(x = Condition.3, y = relative_resp, shape = Condition.1, col = Condition.3)) +
geom_point(size = 10, position = position_dodge(width = 0.8)) +
scale_color_brewer(type = "qual") +
theme(panel.background = element_rect(color = "red", size = 5, linetype = "dashed")) +
theme(axis.ticks.x = element_line(color = "darkblue", size = 2))+
theme(aspect.ratio = 1) +
# xlab("Whatever") +
# ylab("Whatever there") +
# ggtitle(" Serine ") +
theme(plot.title = element_text(vjust = 3, face = "bold", size = 20)) +
labs(x = "somtehing", y = "respo", title = "Serine", caption = "Fig. 1 Serine data") +
# theme(legend.position = "bottom", legend.direction = "vertical")
theme(legend.position = c(0.9, 0.9), legend.direction = "vertical", legend.background = element_rect(fill = "green")) +
# theme(axis.title.x = element_text(size = 20), axis.title.y = element_text(size = 30, face = "italic"))
theme(axis.title = element_text(size = 20))
ggplot(serine_subset, aes(x = Condition.3, y = relative_resp, shape = Condition.1, col = Condition.3)) +
geom_point(size = 10, position = position_dodge(width = 0.8)) +
scale_color_brewer(type = "qual") +
theme(panel.background = element_rect(color = "red", size = 5, linetype = "dashed")) +
theme(axis.ticks.x = element_line(color = "darkblue", size = 2))+
theme(aspect.ratio = 1) +
# xlab("Whatever") +
# ylab("Whatever there") +
# ggtitle(" Serine ") +
theme(plot.title = element_text(vjust = 3, face = "bold", size = 20)) +
labs(x = "somtehing", y = "respo", title = "Serine", caption = "Fig. 1 Serine data") +
# theme(legend.position = "bottom", legend.direction = "vertical")
theme(legend.position = c(0.9, 0.9), legend.direction = "vertical", legend.background = element_rect(fill = "green")) +
# theme(axis.title.x = element_text(size = 20), axis.title.y = element_text(size = 30, face = "italic"))
theme(axis.title = element_text(size = 20)) +
theme(axis.text = element_text(size = 10, face = "bold"))
ggplot(course_df, aes(x = age_a, y = height_cm)) +
geom_point( stroke = 2, aes(col = usedR, size = cat_dog, shape = PC_Linux_Mac)) +
scale_size_manual(values = c(cat = 4, dog = 2)) +
# scale_fill_brewer(palette = "Dark2") +
scale_color_manual(values = c("y" = "darkblue", "n" = "darkred")) +
geom_text(aes(label = name), vjust = -2) +
scale_y_continuous(limits = c(150, 210))
ggplot(course_df, aes(x = age_a, y = height_cm)) +
geom_point( stroke = 2, aes(col = used_ggplot, size = cat_dog, shape = PC_Linux_Mac)) +
scale_size_manual(values = c(cat = 4, dog = 2)) +
# scale_fill_brewer(palette = "Dark2") +
scale_color_manual(values = c("y" = "darkblue", "n" = "darkred")) +
geom_text(aes(label = name), vjust = -2) +
scale_y_continuous(limits = c(150, 210))
ggplot(course_df, aes(x = age_a, y = height_cm)) +
geom_point( stroke = 2, aes(col = used_ggplot, size = cat_dog, shape = PC_Linux_Mac)) +
scale_size_manual(values = c(cat = 4, dog = 2)) +
# scale_fill_brewer(palette = "Dark2") +
scale_color_manual(values = c("y" = "darkblue", "n" = "darkred")) +
geom_text(aes(label = name), vjust = -2)
ggplot(course_df, aes(x = age_a, y = height_cm)) +
geom_point( stroke = 2, aes(col = used_ggplot, size = cat_dog, shape = PC_Linux_Mac)) +
scale_size_manual(values = c(CAT = 4, DOG = 2)) +
# scale_fill_brewer(palette = "Dark2") +
scale_color_manual(values = c("y" = "darkblue", "n" = "darkred")) +
geom_text(aes(label = name), vjust = -2)
ggplot(course_df, aes(x = age_a, y = height_cm)) +
geom_point( stroke = 2, aes(col = used_ggplot, size = cat_dog, shape = PC_Linux_Mac)) +
scale_size_manual(values = c("CAT" = 4, "DOG" = 2)) +
# scale_fill_brewer(palette = "Dark2") +
scale_color_manual(values = c("y" = "darkblue", "n" = "darkred")) +
geom_text(aes(label = name), vjust = -2)
plot.new()
ggplot(course_df, aes(x = age_a, y = height_cm)) +
geom_point( stroke = 2, aes(col = used_ggplot, size = cat_dog, shape = PC_Linux_Mac)) +
scale_size_manual(values = c("CAT" = 4, "DOG" = 2)) +
# scale_fill_brewer(palette = "Dark2") +
scale_color_manual(values = c("y" = "darkblue", "n" = "darkred")) +
geom_text(aes(label = name), vjust = -2)
ggplot(course_df, aes(x = age_a, y = height_cm)) +
geom_point( stroke = 2, aes(col = used_ggplot, size = cat_dog, shape = PC_Linux_Mac)) +
scale_size_manual(values = c("CAT" = 4, "DOG" = 2)) +
# scale_fill_brewer(palette = "Dark2") +
scale_color_manual(values = c("y" = "darkblue", "n" = "darkred")) +
geom_text(aes(label = name), vjust = -2)
dev.off()
ggplot(course_df, aes(x = age_a, y = height_cm)) +
geom_point( stroke = 2, aes(col = used_ggplot, size = cat_dog, shape = PC_Linux_Mac)) +
scale_size_manual(values = c("CAT" = 4, "DOG" = 2)) +
# scale_fill_brewer(palette = "Dark2") +
scale_color_manual(values = c("y" = "darkblue", "n" = "darkred")) +
geom_text(aes(label = name), vjust = -2)
ggplot(course_df, aes(x = age_a, y = height_cm)) +
geom_point( stroke = 2, aes(col = used_ggplot, size = cat_dog, shape = PC_Linux_Mac))
plot.new()
ggplot(course_df, aes(x = age_a, y = height_cm)) +
geom_point( stroke = 2, aes(col = used_ggplot, size = cat_dog, shape = PC_Linux_Mac)) +
scale_size_manual(values = c("CAT" = 4, "DOG" = 2)) +
# scale_fill_brewer(palette = "Dark2") +
scale_color_manual(values = c("y" = "darkblue", "n" = "darkred")) +
geom_text(aes(label = name), vjust = -2)
ggplot(serine_subset, aes(x = Condition.3, y = relative_resp, shape = Condition.1, col = Condition.3)) +
geom_point(size = 10, position = position_dodge(width = 0.8)) +
scale_color_brewer(type = "qual") +
theme(panel.background = element_rect(color = "red", size = 5, linetype = "dashed")) +
theme(axis.ticks.x = element_line(color = "darkblue", size = 2))+
theme(aspect.ratio = 1) +
# xlab("Whatever") +
# ylab("Whatever there") +
# ggtitle(" Serine ") +
theme(plot.title = element_text(vjust = 3, face = "bold", size = 20)) +
labs(x = "somtehing", y = "respo", title = "Serine", caption = "Fig. 1 Serine data") +
# theme(legend.position = "bottom", legend.direction = "vertical")
theme(legend.position = c(0.9, 0.9), legend.direction = "vertical", legend.background = element_rect(fill = "green")) +
# theme(axis.title.x = element_text(size = 20), axis.title.y = element_text(size = 30, face = "italic"))
theme(axis.title = element_text(size = 20)) +
theme(axis.text = element_text(size = 10, face = "bold"))
course_df$cat_dog
ggplot(course_df, aes(x = age_a, y = height_cm)) +
geom_point( stroke = 2, aes(col = used_ggplot, size = cat_dog, shape = PC_Linux_Mac)) +
# scale_size_manual(values = c("CAT" = 4, "DOG" = 2)) +
# scale_fill_brewer(palette = "Dark2") +
scale_color_manual(values = c("y" = "darkblue", "n" = "darkred")) +
geom_text(aes(label = name), vjust = -2)
ggplot(course_df, aes(x = age_a, y = height_cm)) +
# geom_point( stroke = 2, aes(col = used_ggplot, size = cat_dog, shape = PC_Linux_Mac)) +
# scale_size_manual(values = c("CAT" = 4, "DOG" = 2)) +
# scale_fill_brewer(palette = "Dark2") +
scale_color_manual(values = c("y" = "darkblue", "n" = "darkred")) +
geom_text(aes(label = name), vjust = -2)
ggplot(course_df, aes(x = age_a, y = height_cm, col = used_ggplot, size = cat_dog, shape = PC_Linux_Mac)) +
geom_point( stroke = 2, )
ggplot(course_df, aes(x = age_a, y = height_cm, col = used_ggplot, shape = PC_Linux_Mac)) +
geom_point( stroke = 2)
exp2_original <-
read.xlsx('example_data/exp_02_rnaseq/PP2015-01076R2_Supplemental_Dataset_S1.xlsx',
startRow = 21)
View(exp2_original)
exp2_rpm <- exp2_original[, c(1, grep('rpm', ignore.case = T, colnames(exp2_original)))]
colnames(exp2_rpm) <- c('AGI', paste(rep(c(0,4,9,12,'re2'), each = 6),
rep(c('MD', 'MN'), each = 3),
c('rep1', 'rep2', 'rep3'), sep = '_'))
View(exp2_rpm)
## Filter non-expressed genes
exp2_rpm <- exp2_rpm[!rowSums(exp2_rpm[, 2:ncol(exp2_rpm)]) == 0, ]
exp2_rpm_long <- exp2_rpm %>%
pivot_longer(-AGI, values_to = "rpm")
View(exp2_rpm_long)
exp2_rpm_long <- separate(data = exp2_rpm_long, col = name, sep = '_',
into = c("trtmt", "time", "replicate"))
exp2_rpm_long$trtmt <- factor(exp2_rpm_long$trtmt, unique(exp2_rpm_long$trtmt))
View(exp2_rpm_long)
load(file = "exp2.RData")
pca_data <- as.data.frame(pivot_wider(exp2_rpm_long,
names_from = AGI,
values_from =  rpm,
id_cols = c(trtmt, time, replicate)))
pca_data <- unite(pca_data,  trtmt, time, replicate, col = 'merger', sep = '_')
rownames(pca_data) <- pca_data$merger
pca_data <- pca_data[, -1]
pca_data <- pca_data[, apply(pca_data, 2, function(x) {sum(x) != 0})]
pca <- prcomp(pca_data, scale = T)
pcaPlotData <- as.data.frame(pca$x)
pcaPlotData$merger <- rownames(pcaPlotData)
pcaPlotData <- separate(data = pcaPlotData, col = merger, sep = '_',
into = c("trtmt", "time", "replicate"))
View(pca_data)
pca_data <- as.data.frame(pivot_wider(exp2_rpm_long,
names_from = AGI,
values_from =  rpm,
id_cols = c(trtmt, time, replicate)))
pca_data <- unite(pca_data,  trtmt, time, replicate, col = 'merger', sep = '_')
rownames(pca_data) <- pca_data$merger
pca_data <- pca_data[, -1]
pca_data <- pca_data[, apply(pca_data, 2, function(x) {sum(x) != 0})]
View(pca_data)
head(pca_data)
pca <- prcomp(pca_data, scale = T)
pcaPlotData <- as.data.frame(pca$x)
pcaPlotData$merger <- rownames(pcaPlotData)
pcaPlotData <- separate(data = pcaPlotData, col = merger, sep = '_',
into = c("trtmt", "time", "replicate"))
ggplot(pcaPlotData, aes_string(color = 'trtmt', shape = 'time', x = 'PC1', y = 'PC2')) +
geom_point(size = 3,  stroke = 1.5) +
coord_equal() +
theme_dominik +
scale_color_brewer(palette = 'Dark2')
theme_dominik <-
theme(panel.grid = element_blank(), panel.background = element_blank(),
panel.border = element_rect(fill = NA)) +
theme(axis.text = element_text(color = "black"),
axis.ticks = element_line(color = "black"),
axis.title = element_text(color = "black")) +
theme(plot.title = element_text(face= "bold")) +
theme(aspect.ratio = 1) +
theme(strip.background = element_blank(),
strip.text = element_text(size = 7, face = "bold")) +
theme(legend.position = "bottom",  legend.title = element_blank())
ggplot(pcaPlotData, aes_string(color = 'trtmt', shape = 'time', x = 'PC1', y = 'PC2')) +
geom_point(size = 3,  stroke = 1.5) +
coord_equal() +
theme_dominik +
scale_color_brewer(palette = 'Dark2')
View(exp2_annotation)
plyr::count(exp2_annotation$BIN1)
aba_genes <- subset(exp2_annotation, grepl("hormone metabolism.abscisic acid.signal", category))
aba_rpm <- merge(aba_genes, exp2_rpm_long)
aba_stats <- merge(aba_genes, exp2_stats_long)
aba_ymax <- aba_rpm %>%
group_by(gene.name, trtmt, time) %>%
dplyr::summarise(ymax = max(rpm))
aba_stats <- merge(aba_stats, aba_ymax)
aba_plotdata <- summarySE(aba_rpm, groupvars = c('trtmt', 'time', 'gene.name'), measurevar = 'rpm')
aba_plotdata <- merge(aba_plotdata, aba_stats, all.x = T)
ggplot(aba_plotdata, aes(x = trtmt, y = rpm, fill = time)) +
geom_hline(yintercept = 0, col = 'black') +
facet_wrap(~gene.name, scales = 'free') +
geom_col(position = position_dodge(width = 0.7), width = 0.7, col = 'black') +
geom_errorbar(aes(ymin = rpm - sd, ymax = rpm + sd), #
position = position_dodge(width = 0.7), width = 0.1, col = 'black') +
geom_text(aes(label = asterisks, y= 1.1*ymax),
position = position_dodge(width = 0.7), size = 3, col = 'black') +
theme_dominik +
scale_fill_manual(values = c(MD = 'grey90', MN = 'grey20'), labels = c('Midday', 'Midnight')) +
scale_y_continuous(limits = c(0,NA))
load(file = "exp2_kmeans.RData")
ggplot(km_plotdata, aes(x = trtmt, y = z_scores)) +
# geom_violin(aes(group = trtmt), scale = 'width') +
stat_summary(fun = mean, geom = "line", col = "red", aes(group = 1)) +
facet_wrap(~ km, ncol = 5) +
theme_dominik
head(cluster.mship)
plyr::count(cluster.mship$km)
plyr::count(km_plotdata$km)
ggplot(km_plotdata, aes(x = trtmt, y = z_scores)) +
# geom_violin(aes(group = trtmt), scale = 'width') +
stat_summary(fun = mean, geom = "line", col = "grey", aes(group = AGI)) +
stat_summary(fun = mean, geom = "line", col = "red", aes(group = 1)) +
facet_wrap(~ km, ncol = 5) +
theme_dominik
load(file = "exp2_fishers.RData")
load(file = "exp2_fishers.RData")
ggplot(pcaPlotData, aes_string(color = 'trtmt', shape = 'time', x = 'PC1', y = 'PC2')) +
geom_point(size = 3,  stroke = 1.5) +
coord_equal() +
theme_dominik +
scale_color_brewer(palette = 'Dark2')
plotset <- merge(aba_genes, exp2_lfc_long)
ggplot(plotset, aes(x = trtmt, y = gene.name, fill = log2fc)) +
geom_tile() +
scale_fill_gradient2(low =  "#1f78b4", high = "#e41a1c", midpoint = 0) +
theme(aspect.ratio = 7) +
theme_dominik
ggplot(plotset, aes(x = trtmt, y = gene.name, fill = log2fc)) +
scale_fill_gradient2(low =  "#1f78b4", high = "#e41a1c", midpoint = 0) +
geom_point(color = "black", stroke = 1, fill = NA, size = 6, shape = 22) +
geom_point(alpha = 1, stroke = 1, size = 6, shape = 22) +
# geom_text(size = 3, color = "black", vjust = 0.7) +
theme_dominik +
theme(aspect.ratio = 5) +
theme(axis.title = element_blank())
ggplot(plotset, aes(x = trtmt, y = gene.name, fill = log2fc)) +
scale_fill_gradient2(low =  "grey", high = "green", midpoint = 0) +
geom_point(color = "black", stroke = 1, fill = NA, size = 6, shape = 22) +
geom_point(alpha = 1, stroke = 1, size = 6, shape = 22) +
# geom_text(size = 3, color = "black", vjust = 0.7) +
theme_dominik +
theme(aspect.ratio = 5) +
theme(axis.title = element_blank())
ggplot(km_plotdata, aes(x = trtmt, y = z_scores)) +
geom_violin(aes(group = trtmt), scale = 'width') +
# stat_summary(fun = mean, geom = "line", col = "grey", aes(group = AGI)) +
stat_summary(fun = mean, geom = "line", col = "red", aes(group = 1)) +
facet_wrap(~ km, ncol = 5) +
theme_dominik
summary(cars)
---
title: "Test RMarkdown"
author: "Dominik Brilhaus"
date: "11/20/2020"
output:
html_document:
df_print: paged
---
x <-  5
---
title: "Test RMarkdown"
author: "Dominik Brilhaus"
date: "11/20/2020"
output:
html_document:
df_print: paged
---
x <-  5
y <-  10
x * y
x = 5
plot(1:5 ~ 3:6)
plot(1:5 ~ 3:7)
plot(1:5, 3:7)
gwtwd()
getwd()
dir()
load("exp1_plotdata.RData")
library(tidyverse)
library(shiny)
sort(unique(exp1_plotdata$Compound))
available_compounds <- sort(unique(exp1_plotdata$Compound))
available_compounds
sample(available_compounds, size = 1)
sample(available_compounds, size = 1)
sample(available_compounds, size = 1)
x <-  5
y <-  7
x * y
ggplot(serine_subset, aes(x = Condition.3, y = relative_resp, shape = Condition.1, col = Condition.3)) +
geom_point(size = 10, position = position_dodge(width = 0.8)) +
scale_color_brewer(type = "qual") +
theme(panel.background = element_rect(color = "red", size = 5, linetype = "dashed")) +
theme(axis.ticks.x = element_line(color = "darkblue", size = 2))+
theme(aspect.ratio = 1) +
# xlab("Whatever") +
# ylab("Whatever there") +
# ggtitle(" Serine ") +
theme(plot.title = element_text(vjust = 3, face = "bold", size = 20)) +
labs(x = "somtehing", y = "respo", title = "Serine", caption = "Fig. 1 Serine data") +
# theme(legend.position = "bottom", legend.direction = "vertical")
theme(legend.position = c(0.9, 0.9), legend.direction = "vertical", legend.background = element_rect(fill = "green")) +
# theme(axis.title.x = element_text(size = 20), axis.title.y = element_text(size = 30, face = "italic"))
theme(axis.title = element_text(size = 20)) +
theme(axis.text = element_text(size = 10, face = "bold"))
